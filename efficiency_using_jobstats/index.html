
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Efficiency using jobstats - SCoRe user documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#efficiency-using-jobstats" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SCoRe user documentation" class="md-header__button md-logo" aria-label="SCoRe user documentation" data-md-component="logo">
      
  <img src="../logo/score_logo_410x233.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SCoRe user documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Efficiency using jobstats
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/NBISweden/SCoRe_user_doc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Start

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../resources/" class="md-tabs__link">
          
  
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../CONTRIBUTING/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../contact_us/" class="md-tabs__link">
        
  
  
    
  
  Contact us

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SCoRe user documentation" class="md-nav__button md-logo" aria-label="SCoRe user documentation" data-md-component="logo">
      
  <img src="../logo/score_logo_410x233.png" alt="logo">

    </a>
    SCoRe user documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NBISweden/SCoRe_user_doc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Start
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compute
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Courses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../course_materials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Course material
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../efficiency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Efficient compute
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Other
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_host/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web hosting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contact_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contact us
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/NBISweden/SCoRe_user_doc/blob/main/docs/efficiency_using_jobstats.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/NBISweden/SCoRe_user_doc/raw/main/docs/efficiency_using_jobstats.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="efficiency-using-jobstats">Efficiency using <code>jobstats</code><a class="headerlink" href="#efficiency-using-jobstats" title="Anchor link to this section for reference">&para;</a></h1>
<p>There are multiple tools for
<a href="../efficiency/">using your HPC resources efficiently</a> you may need.
This page is about using your HPC resources efficiently
using the <code>jobstats</code> tool.</p>
<p>Here is the general strategy to effectively use your HPC resources:</p>
<details class="- question">
<summary>Want to see a video?</summary>
<p>Watch the YouTube video
<a href="https://youtu.be/W2sd4qsBPdQ">obtain the CPU and memory usage of a job using <code>jobstats</code></a>
to see how to do so.</p>
<p>Watch the YouTube video
<a href="https://youtu.be/0FcREXUcOHc">Efficient HPC resource use, using Slurm and jobstats</a>
to see how the reasoning of this strategy
works out.</p>
</details>
<!-- markdownlint-disable MD013 -->
<pre class="mermaid"><code>flowchart TD
  obtain_data[Obtain CPU and memory usage of a job]
  lower_limit_based_on_memory(Pick the number of cores to have enough memory)
  limited_by_cpu(For that amount of cores, would runtime by limited by CPU?)
  lower_limit_based_on_cpu(Increase the number of cores, so that on average, the right amount of CPUs is booked)

  done(Use that amount of cores)

  add_one(Increase the number of cores by one for safety)

  obtain_data --&gt; lower_limit_based_on_memory
  lower_limit_based_on_memory --&gt; limited_by_cpu
  limited_by_cpu --&gt; |no| add_one
  limited_by_cpu --&gt; |yes| lower_limit_based_on_cpu
  lower_limit_based_on_cpu --&gt; done
  add_one --&gt; done</code></pre>
<!-- markdownlint-enable MD013 -->

<details class="- question">
<summary>Why not look at CPU usage?</summary>
<p>Because CPU is more flexible.</p>
<p>For example, imagine a job with a short CPU spike,
that can be processed by 16 CPUs.
If 1 core has enough memory, use 1 core of memory:
the CPU spike will be turned into a 100% CPU use (of that one core)
for a longer duration.</p>
</details>
<p>To obtain the CPU and memory usage of a job using <code>jobstats</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>jobstats<span class="w"> </span>--plot<span class="w"> </span><span class="o">[</span>job_id<span class="o">]</span>
</code></pre></div>
<p>for example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>jobstats<span class="w"> </span>--plot<span class="w"> </span><span class="m">12345678</span>
</code></pre></div>
<p>A plot is produced showing the resource use per node
for a job that completed successfully and took longer than 5 minutes.</p>
<p>The produced plot will be produced in the local folder
with name
<code>[cluster_name]-[project_name]-[user_name]-[jobid].png</code>,
for example <code>rackham-uppmax1234-sven-876543.png</code>.
Use any image viewer, e.g. <code>eog</code>.</p>
<p>Each plot shows:</p>
<ul>
<li>detailed information in the title.</li>
<li>CPU usage in blue</li>
<li>current memory usage in solid black</li>
<li>overall memory usage in dotted black (if available)</li>
</ul>
<details class="- question">
<summary>Need a worked-out example?</summary>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_milou-b2010042-douglas-8769275_with_border.png" /></p>
<blockquote>
<p>Pick the number of cores to have enough memory</p>
</blockquote>
<p>The dotted black line hits the right-hand vertical axis at 1070%.
This means that 11 cores (i.e. 1100%) would be enough for this job.</p>
<blockquote>
<p>For that amount of cores, would runtime by limited by CPU?</p>
</blockquote>
<p>The answer is 'no'. Having 11 cores would
mean that most of the time only 10 are used.
Only in the CPU spike at the end, the runtime is limited by CPU.
This short time only has a minor impact on the runtime speed.</p>
<blockquote>
<p>Increase the number of cores by one for safety</p>
</blockquote>
<p>This means booking 12 cores is recommended.</p>
</details>
<details class="- question">
<summary>Need another worked-out example?</summary>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_05_with_border.png" /></p>
<blockquote>
<p>Pick the number of cores to have enough memory</p>
</blockquote>
<p>The dotted black line hits the right-hand vertical axis at 90%.
This means that 1 core (i.e. 100%) would be enough for this job.</p>
<blockquote>
<p>For that amount of cores, would runtime by limited by CPU?</p>
</blockquote>
<p>The answer is 'yes'. Having 1 core would
mean that around half the time there is too little CPU power.
This has an effect.</p>
<blockquote>
<p>Increase the number of cores,
so that on average the right amount of CPUs are booked</p>
</blockquote>
<p>This is around 8 cores (800%), as with that amount of cores:</p>
<ul>
<li>half of the time, there is 1 out of 7 cores booked,
  that is 6 too much</li>
<li>half of the time, there is 7 out of 13 cores booked,
  that is 6 too little</li>
</ul>
<p>This is not an exact algorithm and all numbers from 2 to 9 cores
can be considered okay.</p>
</details>
<p>Sometimes, however, it is inevitable to use resources
inefficiently, see <a href="#examples">the examples below</a></p>
<div class="admonition note">
<p class="admonition-title">No queue is possible</p>
<p>If everyone followed these guidelines,
there would probably not even be a queue most of the time!</p>
</div>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Anchor link to this section for reference">&para;</a></h2>
<p>Here are some examples of how inefficient jobs can look
and what you can do to make them more efficient.</p>
<h3 id="inefficient-job-example-1-booking-too-much-cores">Inefficient job example 1: booking too much cores<a class="headerlink" href="#inefficient-job-example-1-booking-too-much-cores" title="Anchor link to this section for reference">&para;</a></h3>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_01_with_border.png" /></p>
<p>Here booking 5 cores is considered okay.</p>
<blockquote>
<p>Pick the number of cores to have enough memory</p>
</blockquote>
<p>The dotted black line hits the right-hand vertical axis at 390%.
This means that 4 cores (i.e. 400%) would be enough for this job.</p>
<blockquote>
<p>For that amount of cores, would runtime by limited by CPU?</p>
</blockquote>
<p>The answer is 'no'. Having 4 cores would
mean that most of the time only 1 are used.
Only for some CPU spikes, the runtime is limited by CPU.
This short time only has a minor impact on the runtime speed.</p>
<blockquote>
<p>Increase the number of cores by one for safety</p>
</blockquote>
<p>This means booking 5 cores is recommended.</p>
<h3 id="inefficient-job-example-2-booking-too-much-cores">Inefficient job example 2: booking too much cores<a class="headerlink" href="#inefficient-job-example-2-booking-too-much-cores" title="Anchor link to this section for reference">&para;</a></h3>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_05_with_border.png" /></p>
<p>This is one of the grayer areas:
booking 2-9 cores is all considered reasonable.</p>
<blockquote>
<p>Pick the number of cores to have enough memory</p>
</blockquote>
<p>The dotted black line hits the right-hand vertical axis at 90%.
This means that 1 core (i.e. 100%) would be enough for this job.</p>
<blockquote>
<p>For that amount of cores, would runtime by limited by CPU?</p>
</blockquote>
<p>The answer is 'yes'. Having 1 core would
mean that around half the time there is too little CPU power.
This has an effect.</p>
<blockquote>
<p>Increase the number of cores,
so that on average the right amount of CPUs are booked</p>
</blockquote>
<p>This is around 8 cores (800%), as with that amount of cores:</p>
<ul>
<li>half of the time, there is 1 out of 7 cores booked,
  that is 6 too much</li>
<li>half of the time, there is 7 out of 13 cores booked,
  that is 6 too little</li>
</ul>
<p>This is not an exact algorithm and all numbers from 2 to 9 cores
can be considered okay.</p>
<h3 id="inefficient-job-example-3">Inefficient job example 3<a class="headerlink" href="#inefficient-job-example-3" title="Anchor link to this section for reference">&para;</a></h3>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_03_with_border.png" /></p>
<p>Here booking 6 cores is considered okay.</p>
<blockquote>
<p>Pick the number of cores to have enough memory</p>
</blockquote>
<p>The dotted black line hits the right-hand vertical axis at 40%.
This means that 1 core (i.e. 100%) would be enough for this job.</p>
<blockquote>
<p>For that amount of cores, would runtime by limited by CPU?</p>
</blockquote>
<p>The answer is 'yes'. Having 1 core would
mean that most of the time our run is limited by CPU power.
This has an impact on the runtime speed.</p>
<blockquote>
<p>Increase the number of cores,
so that on average the right amount of CPUs are booked</p>
</blockquote>
<p>This is around 6 cores (600%), as with that amount of cores:</p>
<ul>
<li>most of the time, there is 6 out of 6 cores booked,
  that is 0 too much</li>
<li>only rarely, there is a little spike up or a bigger spike down</li>
</ul>
<p>There are no signs of anything slowing them down, as the line is very even.</p>
<p>This jobs should either have been booked with 6 cores,
or the program running should be told to use all 8 cores.</p>
<h3 id="inefficient-job-example-4-slowdown">Inefficient job example 4: slowdown<a class="headerlink" href="#inefficient-job-example-4-slowdown" title="Anchor link to this section for reference">&para;</a></h3>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_02_with_border.png" /></p>
<p>This job is using almost all of the cores it has booked,
but there seems to be something holding them back.
The uneven blue curve tells us that something is slowing down the analysis,
and it's not by a constant amount.</p>
<p>Usually this is how it looks when the filesystem is the cause of a slowdown.
Since the load of the filesystem is constantly changing,
so will the speed by which a job can read data from it also change.</p>
<p>This job should try to copy all the files it will be working
with to the nodes local harddrive before running the analysis,
and by doing so not be affected by the speed of the filesystem.</p>
<p>Please see the guide How to use the nodes own hard drive
for analysis for more information.</p>
<p>You basically just add 2 more commands to your script file
and the problem should be solved.</p>
<h3 id="inefficient-job-example-5">Inefficient job example 5<a class="headerlink" href="#inefficient-job-example-5" title="Anchor link to this section for reference">&para;</a></h3>
<p><img alt="jobstats showing a single-node job" src="../jobstats_c_555912-l_1-k_bad_job_04_with_border.png" /></p>
<p>This job has the same problem as the example above,
but in a more extreme way.</p>
<p>It's not uncommon that people book whole nodes out of habit
and only run single threaded programs that use almost no memory.
This job is a bit special in the way that it's being run on a high memory node,
as you can see on the left Y-axis, that it goes up to 256 GB RAM.
A normal node on Milou only have 128GB.
These high memory nodes are only bookable of you book the whole node,
so you can't book just a few cores on them.
That means that if you need 130GB RAM and the program is only single threaded,
your only option is to book a whole high memory node.
The job will look really inefficient,
but it's the only way to do it on our system.
The example in the plot does not fall into this category though,
as it uses only ~15GB of RAM, which you could get by booking 2-3 normal cores.</p>
<!-- Mermaid nodes cannot be split up over lines, hence will break 80 characters per line -->












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["toc.integrate", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.footer", "navigation.expand", "search.suggest", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>